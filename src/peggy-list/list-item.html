<dom-module id="list-item">
	<style>
		:host {
			height: 48px;
			padding: 8px 16px;
		}
		.card {
			display: flex;
			align-items: center;
		}
	</style>
	<template>
		<div hidden="[[_editing]]" class="card">
			<span>[[item.tag]]  $[[item.price]] x [[item.amount]] = [[_calcSubTotal(item.price, item.amount)]]</span>
			<paper-icon-button on-tap="_delete" icon="delete"></paper-icon-button>
			<paper-icon-button on-tap="_edit" icon="editor:mode-edit"></paper-icon-button>
	 	</div>
		<div hidden="[[!_editing]]" class="card">
			<paper-input id="tag"></paper-input>
			<paper-input id="price"></paper-input>
			<paper-input id="amount"></paper-input>
			<paper-icon-button on-tap="_update" icon="check"></paper-icon-button>
		</div>
	</template>
	<script>
		Polymer({
			is: 'list-item',
      properties: {
        item: {
          type: Object
        },
				_editing: {
					type: Boolean,
					value: false
				}
      },
      _delete: function(e) {
				this.fire('delete', {item: this.item});
      },
      _edit: function() {
				//discard unsaved changes.
				this.$.tag.value = this.item.tag;
				this.$.price.value = this.item.price;
				this.$.amount.value = this.item.amount;

				this._editing = true;
				this.fire('edit');
      },
			_update: function() {
				this._editing = false;
				this.fire('update', {
					item: this.item,
					value: {
						tag: this.$.tag.value,
						price: this.$.price.value,
						amount: this.$.amount.value}
					});
			},

			_calcSubTotal: function(price, amount) {
				return price * amount;
			}
		});
	</script>
</dom-module>
