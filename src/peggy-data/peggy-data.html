<dom-module id-"peggy-data">
  <script>
    Polymer({
      is: 'peggy-data',

      properties: {
        cart: {
          type: Array,
          value: [],
          notify: true,
          readOnly: true,
        },
        total: {
          type: Number,
          value: 0,
          notify: true,
        }
      },
      addItem: function(value) {
        this.push('cart', value);
        this._computeTotal();
      },

      deleteItem: function(item) {
        this.arrayDelete('cart', item);
        this._computeTotal();
      },

      updateItem: function(item, value) {
        let index = this.cart.indexOf(item);
        this.set(`cart.${index}`, value);
        this._computeTotal();
      },

      _computeTotal: function() {
        if(!this.cart)
         return;

        this.set('total', this.cart.reduce((a, b) => {
          return a + (b.amount * b.price);
        }, 0));
      }
    });
  </script>
</dom-module>
